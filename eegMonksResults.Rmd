---
title             : "Analytic Meditation vs. Mindfulness Meditation an EEG analysis of monastic meditation practices"
shorttitle        : "analysis of monastic meditation practices"

author: 
  - name          : "Roy David"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    email         : "r.a.david@student.rug.nl"

affiliation:
  - id            : "1"
    institution   : "University of Groningen"

authornote: |
  Student MSc Computational Cognitive Science


abstract: |
  Analytic meditation is commonly practiced by Tibetan Buddhist monks. This consists of two meditation practices: monastic debate and self-debate. These meditation practices are very different from mindfulness meditation in their practice and goal(s). Little is known how these meditation practices compare based on their associated EEG data. This so we can see if there is overlap in cognitive processes between these meditation practices. We found significant differences between monastic debate and self-debate, mindfulness for mid-occipital 9-14 Hz alpha, over time. For mid-frontal 4-9 Hz theta we did not find any significant differences between these meditation practices, apart from (partially) 1/2 monastic debate conditions, over time. Furthermore, we found significant differences in the frontal and occipital areas for alpha, based on average power over time. This study gives novel insight into how analytic meditation and mindfulness meditation compare, based on their associated EEG data.
  
keywords          : "meditation, eeg, debate"
wordcount         : "X"

bibliography      : "r-references.bib"

floatsintext      : no
linenumbers       : yes
draft             : no
mask              : no

figurelist        : no
tablelist         : no
footnotelist      : no

classoption       : "man"
output            : papaja::apa6_pdf
---

```{r setup, include = FALSE}
library("papaja")
r_refs("r-references.bib")
knitr::opts_chunk$set(echo = TRUE)
rm(list = ls())
knitr::opts_knit$set(root.dir = "/Users/roydavid/Downloads/Monks/")
```

```{r analysis-preferences}
# Seed for random number generation
#set.seed(42)
#knitr::opts_chunk$set(cache.extra = knitr::rand_seed)
figDir <- "/Users/roydavid/Documents/FYRP/latex/figs/"
```

```{r message = FALSE, warning = FALSE, echo=FALSE}
library(ggplot2)
library(plyr)
library(plotfunctions)
library(lme4)
library(mgcv)
library(itsadug)
#R.version.string
#packageVersion("lme4")
```

# Methods
We report how we determined our sample size, all data exclusions (if any), all manipulations, and all measures in the study. <!-- 21-word solution (Simmons, Nelson & Simonsohn, 2012; retrieved from http://ssrn.com/abstract=2160588) -->

## Data analysis
We used `r cite_r("r-references.bib")` for all our analyses.


# Results

```{r load EEG data, warning=FALSE}
# load data generated by continousFreqAnalysis.m
#setwd("/Users/roydavid/Downloads/Monks/")

EEG_theta_data <- read.csv(file = 'powspecAllChannelsTheta.csv')
names(EEG_theta_data) <- c("subj","condition","channel","thetaPow","time")
EEG_theta_data <- EEG_theta_data[complete.cases(EEG_theta_data),]
EEG_theta_data$subj <- as.factor(EEG_theta_data$subj)
EEG_theta_data$condition <- as.factor(EEG_theta_data$condition)
levels(EEG_theta_data$condition) <- c("hard", "easy", "reflection", "singlepointed")
EEG_theta_data <- EEG_theta_data[EEG_theta_data$time<=4.75,]
# subset mid-frontal theta
MFtheta <- EEG_theta_data[EEG_theta_data$channel==31,] # Fz
MFtheta_time_average <- ddply(MFtheta, c("time", "condition"), summarise,
                              meanPow = mean(thetaPow, na.rm=TRUE),
                              SE = se(thetaPow, na.rm=TRUE))

# plot mean mid-frontal theta power over time per condition
ggplot(MFtheta_time_average, aes(x=time, y=meanPow, 
                                 ymax=meanPow+SE, ymin=meanPow-SE, 
                                 group=condition)) +
  geom_line(aes(color=condition)) +
  geom_ribbon(alpha = 0.2,aes(fill=condition)) +
  labs(y='mid-frontal log10 theta power',x="time (min.)") +
  theme_minimal()
ggsave(file="/Users/roydavid/Documents/FYRP/latex/figs/FzTheta_avg_time.pdf", width=7, height=4)
# with loess
ggplot(MFtheta_time_average, aes(x=time, y=meanPow, color=condition)) +
  geom_smooth(method='loess') +
  labs(y='mid-frontal log10 theta power',x="time (min.)") +
  guides(color=guide_legend(title="condition")) +
  theme_minimal()
ggsave(file="/Users/roydavid/Documents/FYRP/latex/figs/FzTheta_avg_time_loess.pdf", width=7, height=4)
```
### Mid-frontal theta

```{r}
# mid-frontal theta GAMM analysis

# random intercepts
MFtheta.g1 <- bam(thetaPow ~ condition + s(time, by=condition) + s(subj,bs="re"), data=MFtheta)
summary(MFtheta.g1)
# random slopes
MFtheta.g2 <- bam(thetaPow ~ condition + s(time, by=condition) + s(subj,bs="re") + 
                    s(subj,condition,bs="re"), data=MFtheta)
summary(MFtheta.g2)
compareML(MFtheta.g1,MFtheta.g2)
# factor smooths
MFtheta.g3 <- bam(thetaPow ~ condition + s(time, by=condition) + s(subj,condition,bs="re") + 
                    s(time,subj,bs="fs",m=1), data=MFtheta)
summary(MFtheta.g3)
compareML(MFtheta.g2,MFtheta.g3)
# model power by condition
# smooth over time by condition
# factor smooth over time for each subject by condition:
# (potential) nonlinear difference over time wrt the general pattern for each subject
# by condition
MFtheta.g4 <- bam(thetaPow ~ condition + s(time, by=condition) + 
                    s(time,subj,by=condition,bs="fs",m=1), 
                  data=MFtheta)
summary(MFtheta.g4)
compareML(MFtheta.g2,MFtheta.g4)
compareML(MFtheta.g3,MFtheta.g4)

par(mfrow=c(2,2))
gam.check(MFtheta.g4)
par(mfrow=c(1,1))
acf_resid(MFtheta.g4)
```
```{r}
# mid-frontal theta smooths
plot_smooth(MFtheta.g4, view="time", plot_all="condition",
            xlab = "time (min.)", ylab = "theta power", cex.lab=1.5)
# monastic debate hard vs. easy
plot_diff(MFtheta.g4, view="time", comp=list(condition=c("hard", "easy")))
# monastic debate vs. self-debate
plot_diff(MFtheta.g4, view="time", comp=list(condition=c("hard", "reflection")))
plot_diff(MFtheta.g4, view="time", comp=list(condition=c("easy", "reflection")))
# monastic debate vs. mindfulness
plot_diff(MFtheta.g4, view="time", comp=list(condition=c("hard", "singlepointed")))
plot_diff(MFtheta.g4, view="time", comp=list(condition=c("easy", "singlepointed")))
# self-debate vs. mindfulness
plot_diff(MFtheta.g4, view="time", comp=list(condition=c("reflection", "singlepointed")))
```
```{r}
# (binary) models with difference smooths
MFtheta$IsHard <- ifelse(MFtheta$condition=='hard', 1, 0)
MFtheta$IsEasy <- ifelse(MFtheta$condition=='easy', 1, 0)
MFtheta$IsRefl <- ifelse(MFtheta$condition=='reflection', 1, 0)
MFtheta$IsSingl <- ifelse(MFtheta$condition=='singlepointed', 1, 0)


# (binary) model with difference smooths comparing
# monastic debate hard vs.
MFtheta.g4.bin1 <- bam(thetaPow ~ s(time) 
              + s(time, by=IsSingl) + s(time, by=IsRefl) + s(time, by=IsEasy)
              + s(time,subj,by=condition,bs="fs",m=1)
              ,data=MFtheta)
#summary(MFtheta.g4.bin1)
# (binary) model with difference smooths comparing
# monastic debate easy vs.
MFtheta.g4.bin2 <- bam(thetaPow ~ s(time) 
              + s(time, by=IsSingl) + s(time, by=IsRefl) + s(time, by=IsHard)
              + s(time,subj,by=condition,bs="fs",m=1)
              ,data=MFtheta)
#summary(MFtheta.g4.bin2)
# (binary) model with difference smooths comparing
# self-debate vs.
MFtheta.g4.bin3 <- bam(thetaPow ~ s(time) 
              + s(time, by=IsSingl) + s(time, by=IsEasy) + s(time, by=IsHard)
              + s(time,subj,by=condition,bs="fs",m=1)
              ,data=MFtheta)
#summary(MFtheta.g4.bin3)
# (binary) model with difference smooths comparing
# mindfulness vs.
MFtheta.g4.bin4 <- bam(thetaPow ~ s(time) 
              + s(time, by=IsRefl) + s(time, by=IsEasy) + s(time, by=IsHard)
              + s(time,subj,by=condition,bs="fs",m=1)
              ,data=MFtheta)
#summary(MFtheta.g4.bin4)

report_stats(MFtheta.g4.bin1)
report_stats(MFtheta.g4.bin2)
report_stats(MFtheta.g4.bin3)
report_stats(MFtheta.g4.bin4)
```

(1) The summary statistics of the models with difference smooths show that Reflection (F(2.000, 853.155)=2.59; p=0.076), Singlepointed (F(2.000, 853.155)=2.66; p=0.070) and Easy (F(2.904, 853.155)=0.68; p=0.658), do not differ from Hard.

(2) Singlepointed (F(2.000, 852.790)=1.37; p=0.255), Reflection (F(2.000, 852.790)=2.01; p=0.135), Hard (F(3.253, 852.790)=1.29; p=0.369) not different from Easy.

(3) Singlepointed (F(2.000, 852.803)=0.23; p=0.798), Easy (F(2.207, 852.803)=1.83; p=0.161), Hard (F(3.253, 852.803)=2.44; p=0.069) not different from Reflection.

(4) Reflection (F(2.000, 852.803)=0.23; p=0.798), Easy (F(2.207, 852.803)=1.29; p=0.293), Hard (F(3.253, 852.803)=2.48; p=0.065) not different from Singlepointed.


```{r}
# load data generated by continousFreqAnalysis.m
#setwd("/Users/roydavid/Downloads/Monks/")

EEG_alpha_data <- read.csv(file = 'powspecAllChannelsAlpha.csv')
names(EEG_alpha_data) <- c("subj","condition","channel","alphaPow","time")
EEG_alpha_data <- EEG_alpha_data[complete.cases(EEG_alpha_data),]
EEG_alpha_data$subj <- as.factor(EEG_alpha_data$subj)
EEG_alpha_data$condition <- as.factor(EEG_alpha_data$condition)
levels(EEG_alpha_data$condition) <- c("hard", "easy", "reflection", "singlepointed")
EEG_alpha_data <- EEG_alpha_data[EEG_alpha_data$time<=4.75,]
# subset mid-occipital alpha
MOalpha <- EEG_alpha_data[EEG_alpha_data$channel==16,] # Oz
MOalpha_time_average <- ddply(MOalpha, c("time", "condition"), summarise,
                              meanPow = mean(alphaPow, na.rm=TRUE),
                              SE = se(alphaPow, na.rm=TRUE))

# plot mean mid-occipital alpha power over time per condition
ggplot(MOalpha_time_average, aes(x=time, y=meanPow, 
                                 ymax=meanPow+SE, ymin=meanPow-SE, 
                                 group=condition)) +
  geom_line(aes(color=condition)) +
  geom_ribbon(alpha = 0.2,aes(fill=condition)) +
  labs(y='mid-occipital log10 alpha power',x="time (min.)") +
  theme_minimal()
ggsave(file="/Users/roydavid/Documents/FYRP/latex/figs/OzAlpha_avg_time.pdf", width=7, height=4)
# with loess
ggplot(MOalpha_time_average, aes(x=time, y=meanPow, color=condition)) +
  geom_smooth(method='loess') +
  labs(y='mid-occipital log10 alpha power',x="time (min.)") +
  guides(color=guide_legend(title="condition")) +
  theme_minimal()
ggsave(file="/Users/roydavid/Documents/FYRP/latex/figs/OzAlpha_avg_time_loess.pdf", width=7, height=4)
```

### Mid-occipital alpha

```{r}
# mid-occipital alpha GAMM analysis

# random intercepts
MOalpha.g1 <- bam(alphaPow ~ condition + s(time, by=condition) + s(subj,bs="re"), data=MOalpha)
#summary(MOalpha.g1)
# random slopes
MOalpha.g2 <- bam(alphaPow ~ condition + s(time, by=condition) + s(subj,bs="re") + 
                    s(subj,condition,bs="re"), data=MOalpha)
#summary(MOalpha.g2)
compareML(MOalpha.g1,MOalpha.g2)
# factor smooths
MOalpha.g3 <- bam(alphaPow ~ condition + s(time, by=condition) + s(subj,condition,bs="re") + 
                    s(time,subj,bs="fs",m=1), data=MOalpha)
#summary(MOalpha.g3)
compareML(MOalpha.g2,MOalpha.g3)
# model power by condition
# smooth over time by condition
# factor smooth over time for each subject by condition:
# (potential) nonlinear difference over time wrt the general pattern for each subject
# by condition
MOalpha.g4 <- bam(alphaPow ~ condition + s(time, by=condition) + s(time,subj,by=condition,bs="fs",m=1), 
                  data=MOalpha)
summary(MOalpha.g4)
compareML(MOalpha.g2,MOalpha.g4)
compareML(MOalpha.g3,MOalpha.g4)

par(mfrow=c(2,2))
gam.check(MOalpha.g4)
par(mfrow=c(1,1))
acf_resid(MOalpha.g4)
```
```{r}
plot_smooth(MOalpha.g4, view="time", plot_all="condition",
            xlab = "time (min.)", ylab = "alpha power", cex.lab=1.5)
# monastic debate hard vs. easy
plot_diff(MOalpha.g4, view="time", comp=list(condition=c("hard", "easy")))
# monastic debate vs. self-debate
plot_diff(MOalpha.g4, view="time", comp=list(condition=c("hard", "reflection")))
plot_diff(MOalpha.g4, view="time", comp=list(condition=c("easy", "reflection")))
# monastic debate vs. mindfulness
plot_diff(MOalpha.g4, view="time", comp=list(condition=c("hard", "singlepointed")))
plot_diff(MOalpha.g4, view="time", comp=list(condition=c("easy", "singlepointed")))
# self-debate vs. mindfulness
plot_diff(MOalpha.g4, view="time", comp=list(condition=c("reflection", "singlepointed")))
```
```{r}
# (binary) models with difference smooths
MOalpha$IsHard <- ifelse(MOalpha$condition=='hard', 1, 0)
MOalpha$IsEasy <- ifelse(MOalpha$condition=='easy', 1, 0)
MOalpha$IsRefl <- ifelse(MOalpha$condition=='reflection', 1, 0)
MOalpha$IsSingl <- ifelse(MOalpha$condition=='singlepointed', 1, 0)


# (binary) model with difference smooths comparing
# monastic debate hard vs.
MOalpha.g4.bin1 <- bam(alphaPow ~ s(time) 
              + s(time, by=IsSingl) + s(time, by=IsRefl) + s(time, by=IsEasy)
              + s(time,subj,by=condition,bs="fs",m=1)
              ,data=MOalpha)
#summary(MOalpha.g4.bin1)
# (binary) model with difference smooths comparing
# monastic debate easy vs.
MOalpha.g4.bin2 <- bam(alphaPow ~ s(time) 
              + s(time, by=IsSingl) + s(time, by=IsRefl) + s(time, by=IsHard)
              + s(time,subj,by=condition,bs="fs",m=1)
              ,data=MOalpha)
#summary(MOalpha.g4.bin2)
# (binary) model with difference smooths comparing
# self-debate vs.
MOalpha.g4.bin3 <- bam(alphaPow ~ s(time) 
              + s(time, by=IsSingl) + s(time, by=IsEasy) + s(time, by=IsHard)
              + s(time,subj,by=condition,bs="fs",m=1)
              ,data=MOalpha)
#summary(MOalpha.g4.bin3)
# (binary) model with difference smooths comparing
# mindfulness vs.
MOalpha.g4.bin4 <- bam(alphaPow ~ s(time) 
              + s(time, by=IsEasy) + s(time, by=IsRefl) + s(time, by=IsHard)
              + s(time,subj,by=condition,bs="fs",m=1)
              ,data=MOalpha)
#summary(MOalpha.g4.bin4)

report_stats(MOalpha.g4.bin1)
report_stats(MOalpha.g4.bin2)
report_stats(MOalpha.g4.bin3)
report_stats(MOalpha.g4.bin4)
```

(1) The summary statistics of the models with difference smooths show that Reflection (F(2.000, 886.446)=7.97; p<.001), Singlepointed (F(2.938, 886.446)=4.15; p<.01), differ from Hard but not Easy (F(2.000, 886.446)=0.94; p=0.392).

(2) Singlepointed (F(2.938, 886.446)=4.19; p<.01), Reflection (F(2.000, 886.446)=9.79; p<.001), differ from Easy but not Hard (F(2.000, 886.446)=0.94; p=0.392).

(3) Easy (F(2.000, 886.446)=9.79; p<.001), Hard (F(2.000, 886.446)=7.97; p<.001) differ from Reflection but not Singlepointed (F(2.938, 886.446)=1.03; p=0.477).

(4) Easy (F(2.000, 886.714)=6.23; p<.01), Hard (F(2.000, 886.714)=6.16; p<.01) differ from Singlepointed but not Reflection (F(2.000, 886.714)=0.83; p=0.437).


# Discussion


\newpage

# References

::: {#refs custom-style="Bibliography"}
:::
